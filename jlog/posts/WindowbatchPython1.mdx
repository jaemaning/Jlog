---
title: "Window batch íŒŒì¼ì„ Python ì—ì„œ ë™ì‘í•´ë³´ê¸°"
description: "window OS ë¥¼ ì‚¬ìš©í•˜ë‹¤ë³´ë©´ ë‹¤ìŒê³¼ê°™ì€ íŒŒì¼ë“¤ì€ ìì£¼ ë³´ê²Œë©ë‹ˆë‹¤. ì €í¬ê°€ ë¹„ë¡ ëª°ë¼ë„ ë˜ì§€ë§Œ ë§Œì•½ exe ì‹¤í–‰íŒŒì¼ì„ ê°œë°œí•´ì„œ í•´ë‹¹ ì‹¤í–‰íŒŒì¼ì— ë©”ëª¨ì¥ê³¼ ê°™ì€ ë°ì´í„°ë¥¼ ë„£ì–´ ê²°ê³¼ë¥¼ ë°›ì•„ì•¼ í•œë‹¤ë©´ ì–´ë–»ê²Œ ë ê¹Œìš”??"
date: 2024-03-25T08:49:00.743Z
tags: ["python"]
---


## ğŸ¤” window batch íŒŒì¼

![](/images/5fcc278e-72bc-4f77-bb40-4018993d3834-image.png)

window OS ë¥¼ ì‚¬ìš©í•˜ë‹¤ë³´ë©´ ë‹¤ìŒê³¼ê°™ì€ íŒŒì¼ë“¤ì€ ìì£¼ ë³´ê²Œë©ë‹ˆë‹¤. ì €í¬ê°€ ë¹„ë¡ ëª°ë¼ë„ ë˜ì§€ë§Œ ë§Œì•½ exe ì‹¤í–‰íŒŒì¼ì„ ê°œë°œí•´ì„œ í•´ë‹¹ ì‹¤í–‰íŒŒì¼ì— ë©”ëª¨ì¥ê³¼ ê°™ì€ ë°ì´í„°ë¥¼ ë„£ì–´ ê²°ê³¼ë¥¼ ë°›ì•„ì•¼ í•œë‹¤ë©´ ì–´ë–»ê²Œ ë ê¹Œìš”??

ì €ëŠ” ì‹¤ì œë¡œ ì´ëŸ¬í•œ ê²½í—˜ì„ ê²ªê²Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¹ì—°íˆ DB ì— ë°ì´í„°ë¥¼ ì €ì¥í•´ë‘ê³  í•„ìš”í•œ ë°ì´í„°ë§Œ êº¼ë‚´ì„œ í”„ë¡œê·¸ë˜ë° í•´ì„œ ì“°ë©´ ë˜ëŠ”ê±° ì•„ë‹ˆì•¼? ë¼ê³  í•˜ì‹¤ ìˆ˜ ìˆì§€ë§Œ ì•„ë‹ˆì—ˆìŠµë‹ˆë‹¤.. ë°ì´í„°ê°€ ì‹¤ì œë¡œ ì—‘ì…€, ë©”ëª¨ì¥ë“±ìœ¼ë¡œ ì‹¤ë¬´ìì˜ PCì—ì„œë§Œ ê´€ë¦¬ ë˜ëŠ” ê²ƒë„ ë³´ì•˜ê³  (ë‚´ë¶€ë§ì´ê¸°ì— ë³´ì•ˆì€ ê´œì°®ê² ì§€ë§Œ..) ë°ì´í„° ì²˜ë¦¬ë¥¼ í•  ë•Œ ëˆ„êµ°ê°€ ë¨¼ ì˜›ë‚  ë‹¤ë¥¸ ê°œë°œìê°€ ë§Œë“¤ì–´ ë‘”ë“¯í•œ exe ì‹¤í–‰ íŒŒì¼ì„ ì‹¤í–‰ì‹œì¼œ í•œë•€í•œë•€ input ë°ì´í„°ë¥¼ ì…ë ¥í•˜ë©° ì§„í–‰í•˜ëŠ” ê²ƒë„ ë³´ì•˜ìŠµë‹ˆë‹¤.

ê·¸ë ‡ê²Œ ì €ëŠ” db êµ¬ì¶•ì€ ì œ ê¶Œí•œì™¸ê¸°ì— ì–´ë µì§€ë§Œ ë‚´ë¶€ë§ pcì—ì„œ python anaconda ë¥¼ ê°€ì ¸ì™€ ì„¤ì¹˜í•˜ê³  window OS ìƒì—ì„œ batch íŒŒì¼ë“¤ì„ ë§Œë“¤ê³  pythonì½”ë“œë¡œ êµ¬í˜„ í•´ë³´ì•˜ìŠµë‹ˆë‹¤.


## ğŸ‘€ Python ì—ì„œ window batch íŒŒì¼ ëŒë ¤ë³´ê¸°
ê¸°ë³¸ì ìœ¼ë¡œ python ì—ì„œ os ì— ì ‘ê·¼í•´ì„œ ì‰˜ìŠ¤í¬ë¦½íŠ¸ë‚˜ ì‰˜ ëª…ë ¹ì–´ë¥¼ ë™ì‘í•˜ë ¤ê³ í•˜ë©´ í¬ê²Œ os, subprocess ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ë™ì‘í•œë‹¤. ë‚´ê°€ subprocess ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•œ ì´ìœ ëŠ” os.systemp ëª…ë ¹ì–´ì—ì„  ì„±ê³µ ìœ ë¬´ë§Œ ì•Œë ¤ì¤„ ë¿ ê²°ê³¼ë¥¼ ë³€ìˆ˜ì— ì €ì¥í•  ìˆ˜ëŠ” ì—†ì—ˆë‹¤. ë‚˜ëŠ” ì¶”ê°€ì ìœ¼ë¡œ í•´ë‹¹ ê²°ê³¼ë¥¼ ê°€ì§€ê³  ì‘ì—…ì„ ì§„í–‰í•  ìˆ˜ë„ ìˆê¸°ì— ë³€ìˆ˜ì— ì €ì¥í•´ì„œ ê´€ë¦¬í•  ìˆ˜ ìˆë„ë¡ subprocess ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì˜€ë‹¤.
(ê°„ë‹¨í•˜ê²Œ í´ë” ìƒì„±, ì¡°íšŒ ë“±ì€ os ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ë” ê°„ë‹¨í•˜ì—¬ í•´ë‹¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì˜€ë‹¤.)



```python
import shutil
import subprocess
import time


try:
	_NEED_FIELS = ['Mep.exe', 'test.bat', 'test2.bat']
	f1 = os.listdir('./')

	for filen in _NEED_FIELS:
		if not filen in fl:
			print("Mep.exe, test.bat, test2.bat íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ì•ŠìŠµë‹ˆë‹¤.")
        else:
        	shutil.copy(f'./{filen}', f'./output/{_TITLE}/')
    else:
    	commands = ['test.bat', 'test2.bat']
        path_to_directory = f'output/{_TITLE}'
        for command in commands:
        	time.sleep(1)
            proc = subprocess.run(command, stdout=subprocess.PIPE, stderr=subprocess.PIPE, shell=True, cwd=path_to_directory)
            time.sleep(1)

			if proc.stdout:
            	for po in proc.stdout:
                	print(po)
            else:
            	for pe in proc.stderr:
                	print(pe)
 except:
 	print("error: [ì—ëŸ¬ì½”ë“œ]")

```





## ğŸ’¡ ëŠë‚€ì 
ì•„ë¥´ë°”ì´íŠ¸ í˜•íƒœì§€ë§Œ ê°œë°œìê°€ ì—†ëŠ” ê³³ì—ì„œ ì‹¤ë¬´ìë“¤ê³¼ ì´ì•¼ê¸°í•˜ë©° ë‹¨ìˆœ ë°˜ë³µ ì—…ë¬´ë¥¼ ìë™í™”í•˜ì—¬ íš¨ìœ¨ì ìœ¼ë¡œ ì—…ë¬´ë¥¼ ì§„í–‰í•˜ë‹¤ë³´ë‹ˆ ì¬ë°ŒëŠ” ì¼ì´ ë§ì€ ê²ƒ ê°™ìŠµë‹ˆë‹¤. AWS ì„œë²„ì— db êµ¬ì¶•ê¹Œì§€í•´ì„œ ì œëŒ€ë¡œ ì—…ë¬´ë¥¼ í•˜ê³  ì‹¶ì§€ë§Œ ê·¸ë ‡ê²Œ í•  ìˆ˜ ì—†ëŠ” ì ì´ ì•„ì‰¬ì› ê³ , ì‹¤ì œ ì‹¤ë¬´ìë¶„ë“¤ê»˜ì„œ ì™¸ì£¼ë¡œ ë§¡ê¸´ db ìš´ì˜ í•´ì£¼ëŠ” ì—…ì²´ëŠ” ë‹¨ìˆœí•œ ìë£Œ ë³€ê²½ ìš”ì²­(db í…Œì´ë¸”ì´ 2ê°œë¼ë˜ë°..)ë§ˆì €ë„ ì–´ë µë‹¤, ë°”ì˜ë‹¤, ë³¸ì‚¬ë¥¼ í†µí•´ ë§í•´ë‹¬ë¼ ë“± ì–´ë ¤ì›€ì´ ë§ì€ ê²ƒ ê°™ê³  db ì— ì§ì ‘ ë¶™ì„ ìˆ˜ ìˆëŠ” ê¶Œí•œë„ ì—†ë‹¤ê³ í•˜ë‹ˆ ì•ˆíƒ€ê¹Œì› ë‹¤..

ë¬¼ë¡  ì¢‹ì€ ê°œë°œìë¶„ë“¤ë„ ë„ˆë¬´ ë§ì§€ë§Œ, **ê°œë°œìë¶„ë“¤ì€ ë¹„ê°œë°œìë¶„ë“¤ê³¼ì˜ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ ëŠ¥ë ¥ë„ ì¤‘ìš”í•œ ëŠ¥ë ¥ì¸ ê²ƒ ê°™ë‹¤ê³  ëŠë¼ê²Œ ë˜ëŠ” ê³„ê¸°ì˜€ë‹¤.**



## ğŸ”­ ì „ì²´ì½”ë“œ
```python
import xlwings as xw
import pandas as pd
import os
import shutil
import subprocess
import time


def GetDataFrame(file_name, sheet_num=1):
	wb = wx.Book(file_name)
    s = wb.sheets(sheet_num).used_range.value
    data = pd.DataFrame(s)
    data = data.dropna(how='all', axis=1)
    data = data.dropna(how='all', axis=0)
    return data
    
    
def CheckInputFiles(s):
	folder_path = f'./{s}'
    
    file_names = os.listdir(folder_path)
    
    result = []
    
    for fn in file_names:
    	if not fn[:2] == "~$":
        	result.append(fn)
    
    return result


if __name__ == '__main__':
	try:
    	fn_list = CheckInputFiles("input")
        
        for idx in range(len(fn_list)):
            fn = fn_list[idx]
            df = GetDataFrame(f"./input/{fn}", 1)
            
            # íƒ€ì´í‹€ ì„¤ì •
            _TITLE, _ = fn.split(".")
            _TITLE = "2023_" + _TITLE
            
            # ì¶”ì¶œí•  ROW ë²”ìœ„ ì„¤ì •
            start = 4
            end = CheckRange(start, df)
            _ROW_RANGE = [i for i in range(start,end)]
            
            # í´ë” ëª…
            folder_path = f"./output/{_TITLE}"
            
            if os.path.exists(folder_path):
            	result = input("í˜„ì¬ í•´ë‹¹ í´ë”ê°€ ì´ë¯¸ ì¡´ì¬í•©ë‹ˆë‹¤. ë®ì–´ ì”Œì›Œ ì‘ì„±í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (Y/N)"
            else:
            	result = "Y"
               
            if result == "Y":
            	try:
                	os.makedirs(folder_path, exist_ok=True)
                    print("í´ë” ìƒì„±")
                    MakeUFiles() # ì—‘ì…€ìë£Œ ì •ë¦¬í•˜ëŠ” í•¨ìˆ˜ ë¸”ë¡œê·¸ì—ì„  ë”°ë¡œ ì •ì˜í•˜ì§€ ì•ŠìŒ
                    try:
                    	_NEED_FIELS = ['Mep.exe', 'test.bat', 'test2.bat']
                        f1 = os.listdir('./')
                        
                        for filen in _NEED_FIELS:
                        	if not filen in fl:
                            	print("Mep.exe, test.bat, test2.bat íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ì•ŠìŠµë‹ˆë‹¤.")
                            else:
                            	shutil.copy(f'./{filen}', f'./output/{_TITLE}/')
                        else:
                        	commands = ['test.bat', 'test2.bat']
                            path_to_directory = f'output/{_TITLE}'
                            for command in commands:
                            	time.sleep(1)
                                proc = subprocess.run(command, stdout=subprocess.PIPE, stderr=subprocess.PIPE, shell=True, cwd=path_to_directory)
                                time.sleep(1)
                                
                                if proc.stdout:
                                	for po in proc.stdout:
                                    	print(po)
                                else:
                                	for pe in proc.stderr:
                                    	print(pe)
                    except:
                    	print("error: [ì—ëŸ¬ì½”ë“œ]")
                except:
                	print("error: [ì—ëŸ¬ì½”ë“œ]
            else:
            	print("ì‘ì—…ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.")
        
        print("ëª¨ë“  ì‘ì—…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.")
                                    
	except:
    	print("error: [ì—ëŸ¬ì½”ë“œ]")
```